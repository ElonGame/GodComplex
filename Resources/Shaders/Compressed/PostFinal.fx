#include"Inc/Global.fx"
Texture2D _TexNoise:register(t0),_TexHDR:register(t1);cbuffer cbTextureLOD:register( b1){float _LOD;};struct VS_IN{float4 Position:SV_POSITION;};VS_IN VS(VS_IN V){return V;}float4 r(float2 V){float3 x=float3(0.,-4.f,0.),E=float3(0,1,0),L=float3(0.,0.,0.),r=10.*1..xxx,t=.5*1..xxx,f=_Camera2World[3].xyz,a=mul(float4(V.xy*_CameraData.xy,1.,0.),_Camera2World).xyz;float P=dot(f-x,E)/dot(a,E);return.5*pow(abs(P),.25);}float4 PS(VS_IN V):SV_TARGET0{float4 x=TEX2D(_TexHDR,LinearWrap,V.Position.xy*INV_SCREEN_SIZE);float2 P=2.*float2(ASPECT_RATIO*V.Position.x,V.Position.y)*INV_SCREEN_SIZE;float4 f=r(P);return lerp(f,x,x.w);}